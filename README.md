<p align="center">
  <img src="https://img.shields.io/badge/HACKLYTICS-2026-FF6B35?style=for-the-badge&labelColor=1a1a2e&logo=data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iI0ZGRDcwMCI+PHBhdGggZD0iTTEyIDJMMiA3bDEwIDUgMTAtNS0xMC01ek0yIDE3bDEwIDUgMTAtNS0xMC01LTEwIDV6TTIgMTJsMTAgNSAxMC01LTEwLTUtMTAgNXoiLz48L3N2Zz4="/>
</p>

<p align="center">
  <picture>
    <source media="(prefers-color-scheme: dark)" srcset="https://readme-typing-svg.demolab.com?font=Outfit&weight=800&size=60&duration=3000&pause=1000&color=FFD700&center=true&vCenter=true&multiline=true&repeat=true&width=900&height=80&lines=LUMOS.AI">
    <img src="https://readme-typing-svg.demolab.com?font=Outfit&weight=800&size=60&duration=3000&pause=1000&color=FFD700&center=true&vCenter=true&multiline=true&repeat=true&width=900&height=80&lines=LUMOS.AI" alt="Lumos.AI"/>
  </picture>
</p>

<p align="center">
  <img src="https://readme-typing-svg.demolab.com?font=JetBrains+Mono&weight=500&size=22&duration=4000&pause=2000&color=C0C0C0&center=true&vCenter=true&repeat=true&width=850&height=35&lines=%E2%9C%A8+Real-Time+Safety+Intelligence+%E2%80%94+Powered+by+AI+%E2%9C%A8;%F0%9F%9B%A1%EF%B8%8F+25-Feature+XGBoost+%C3%97+Gemini+2.5+Flash+%C3%97+12%2C000%2B+Agencies;%F0%9F%8C%8D+Every+Address+in+America.+One+Safety+Score.;%F0%9F%93%9E+AI+Emergency+Operator+%E2%80%94+Calls+911+When+You+Can%27t+Speak" alt="Typing SVG" />
</p>

<p align="center">
 <a href="https://lumos-safety.netlify.app">
  <img src="https://img.shields.io/badge/%F0%9F%8C%90_LIVE_DEMO-lumos--safety.netlify.app-FFD700?style=for-the-badge&labelColor=0d1117" alt="Live Demo"/>
</a>
  <a href="#-quick-start"><img src="https://img.shields.io/badge/âš¡_GET_STARTED-5_Minutes-00D4AA?style=for-the-badge&labelColor=0d1117" alt="Quick Start"/></a>
</p>

<p align="center">
  <img src="https://img.shields.io/badge/React_18-61DAFB?style=flat-square&logo=react&logoColor=black" alt="React"/>
  <img src="https://img.shields.io/badge/TypeScript-3178C6?style=flat-square&logo=typescript&logoColor=white" alt="TypeScript"/>
  <img src="https://img.shields.io/badge/Vite_5-646CFF?style=flat-square&logo=vite&logoColor=white" alt="Vite"/>
  <img src="https://img.shields.io/badge/Tailwind_CSS-06B6D4?style=flat-square&logo=tailwindcss&logoColor=white" alt="Tailwind"/>
  <img src="https://img.shields.io/badge/FastAPI-009688?style=flat-square&logo=fastapi&logoColor=white" alt="FastAPI"/>
  <img src="https://img.shields.io/badge/XGBoost-FF6600?style=flat-square&logo=xgboost&logoColor=white" alt="XGBoost"/>
  <img src="https://img.shields.io/badge/Gemini_2.5_Flash-4285F4?style=flat-square&logo=google&logoColor=white" alt="Gemini"/>
  <img src="https://img.shields.io/badge/Firebase-FFCA28?style=flat-square&logo=firebase&logoColor=black" alt="Firebase"/>
  <img src="https://img.shields.io/badge/Mapbox_GL-000000?style=flat-square&logo=mapbox&logoColor=white" alt="Mapbox"/>
  <img src="https://img.shields.io/badge/Python_3.11-3776AB?style=flat-square&logo=python&logoColor=white" alt="Python"/>
</p>

<br/>

---

<br/>

> **ğŸ† Built for Hacklytics 2026** â€” Georgia Tech's premier data science hackathon.
>
> Lumos doesn't just show you crime data. It understands your context â€” *who* you are, *when* you're traveling, *how* you're moving â€” and computes a **personalized safety score** using real crime intelligence from **12,000+ law enforcement agencies**, an **XGBoost model trained on 25 features**, and **Gemini 2.5 Flash** for context-aware reasoning. And if you're ever in danger, Lumos can **call 911 for you** using an AI voice operator.

<br/>

## ğŸ§­ Table of Contents

<details open>
<summary><b>Click to expand</b></summary>

- [âœ¨ What is Lumos?](#-what-is-lumos)
- [ğŸ¯ Key Features](#-key-features)
- [ğŸ—ï¸ System Architecture](#ï¸-system-architecture)
- [ğŸ§  How the Safety Score Works](#-how-the-safety-score-works)
- [ğŸ“ AI Emergency Operator](#-ai-emergency-operator)
- [ğŸ—‚ï¸ Data Pipeline](#ï¸-data-pipeline)
- [ğŸ› ï¸ Tech Stack](#ï¸-tech-stack)
- [ğŸ”Œ API Integrations](#-api-integrations)
- [ğŸ“¡ Backend API Reference](#-backend-api-reference)
- [âš¡ Quick Start](#-quick-start)
- [ğŸ“ Project Structure](#-project-structure)
- [ğŸ§ª Testing](#-testing)
- [ğŸš€ Deployment](#-deployment)
- [ğŸ› Troubleshooting](#-troubleshooting)
- [ğŸ‘¥ Team](#-team)

</details>

<br/>

---

<br/>

## âœ¨ What is Lumos?

<table>
<tr>
<td width="60%">

**Lumos** is a real-time safety intelligence platform that answers one question:

> ***"Is it safe here, right now, for me?"***

Unlike static crime maps that show outdated dots on a screen, Lumos synthesizes **15+ data sources** in parallel â€” FBI crime databases, live Citizen app incidents, weather data, event feeds, moon illumination, and more â€” into a single **personalized safety score (0â€“100)** using a hybrid ML pipeline.

Every score is contextualized by:
- â° **Time of day** â€” BJS-derived temporal crime multipliers
- ğŸ‘¤ **Personal factors** â€” gender, group size, travel mode
- ğŸŒ¦ï¸ **Weather conditions** â€” real-time NWS severity
- ğŸŒ™ **Lunar phase** â€” moon illumination correlates with visibility
- ğŸ“¡ **Live incidents** â€” real-time Citizen app feed with 5-factor decay scoring
- ğŸ­ **Local events** â€” Ticketmaster crowd density proxy

</td>
<td width="40%">

```
        â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
        â•‘                      â•‘
        â•‘   ğŸŸ¢ SAFETY: 82     â•‘
        â•‘   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â•‘
        â•‘   Atlanta, GA        â•‘
        â•‘   2:30 PM Â· Sunny    â•‘
        â•‘                      â•‘
        â•‘   â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘  â•‘
        â•‘   Violent    Property â•‘
        â•‘                      â•‘
        â•‘   ğŸ“Š 24-Hour Curve   â•‘
        â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
        â•‘   â”‚    â•±â•²         â”‚   â•‘
        â•‘   â”‚   â•±  â•²  â•±â•²   â”‚   â•‘
        â•‘   â”‚â”€â”€â•±â”€â”€â”€â”€â•²â•±â”€â”€â•²â”€â”€â”‚   â•‘
        â•‘   â”‚ â•±          â•² â”‚   â•‘
        â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
        â•‘   6AM    12PM   11PM â•‘
        â•‘                      â•‘
        â•‘  ğŸ¤– AI: "Stick to   â•‘
        â•‘  well-lit streets    â•‘
        â•‘  near Peachtree..."  â•‘
        â•‘                      â•‘
        â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

</td>
</tr>
</table>

<br/>

---

<br/>

## ğŸ¯ Key Features

<table>
<tr>
<td align="center" width="33%">

### ğŸ¯ Safety Scoring
**25-Feature XGBoost + Formula Hybrid**

ML prediction (60%) blended with a physics-inspired formula fallback (40%) as a guardrail. Features include NIBRS agency crime rates, temporal profiles, weather severity, officer density, moon illumination, and live event feeds.

</td>
<td align="center" width="33%">

### ğŸŒ 3D Globe Visualization
**Cinematic Mapbox GL Experience**

Auto-rotating 3D globe with fog + starfield, cinematic `flyTo` animations, dual heatmap layers (crime density + live incidents), color-coded route polylines, and POI markers â€” all theme-aware.

</td>
<td align="center" width="33%">

### ğŸ“ AI Emergency Operator
**"LUMOS AI, calling on behalf of..."**

VAPI-powered outbound calls with Gemini 2.5 Flash as the conversational AI, ElevenLabs voice synthesis, and Deepgram Nova-2 transcription. Relays GPS updates every 30 seconds.

</td>
</tr>
<tr>
<td align="center" width="33%">

### ğŸ—ºï¸ Route Safety Analysis
**Segment-by-Segment Risk Scoring**

Enter origin â†’ destination. Google Routes API generates waypoints. Each segment scored independently. Color-coded visualization (green â†’ yellow â†’ red). Time advancement per segment. Overall minimum-aware safety score.

</td>
<td align="center" width="33%">

### ğŸš¶ Walk With Me
**GPS Guardian Angel Mode**

Real-time walk tracking with Haversine distance-to-destination, elapsed time, auto-arrival detection (50m radius), Web Share API location sharing, and direct 911 button. Your digital walking buddy.

</td>
<td align="center" width="33%">

### ğŸ¤– AI Safety Chat
**Context-Aware Gemini Assistant**

Floating chat widget powered by Gemini 2.5 Flash with full location context, 10-message conversation history, suggested questions, and typing indicator. Ask anything about safety.

</td>
</tr>
<tr>
<td align="center" width="33%">

### ğŸ“Š Hourly Risk Curve
**24-Hour Predictive Timeline**

Area chart showing predicted risk levels across all 24 hours using BJS temporal crime multipliers per offense type (robbery 3.07Ã— at night, assault 1.69Ã—). "Now" reference line. Dynamic risk-colored fill.

</td>
<td align="center" width="33%">

### ğŸ“ˆ Historical Trends
**Multi-Year FBI Crime Intelligence**

Line charts tracking violent and property crime rates over multiple years via FBI Crime Data Explorer API. Trend direction indicators show whether crime is rising or falling.

</td>
<td align="center" width="33%">

### ğŸ”´ Live Incidents
**Real-Time Citizen Feed**

Proxied Citizen app trending incidents with severity badges (ğŸ”´ critical â†’ ğŸŸ¢ low), relative timestamps, and clickable map focus. Powers the Citizen Incident Adjustment (CIA) scoring.

</td>
</tr>
<tr>
<td align="center" width="33%">

### ğŸ¥ Nearby POIs
**Safety-Critical Locations**

Police stations, hospitals, and fire stations within radius. Distance calculations. Click to focus on map. Powered by Google Places (New) API.

</td>
<td align="center" width="33%">

### ğŸ’¡ AI Safety Tips
**Gemini-Generated Guidance**

4 structured tips with priority badges (ğŸ”´ critical â†’ ğŸŸ¢ general). Context-aware based on location, time, weather, and crime patterns. Static fallback for reliability.

</td>
<td align="center" width="33%">

### ğŸ“„ Reports & Sharing
**Save, Export, Share**

Firestore-backed report saving. `.txt` export with ASCII art header. URL-parameter shareable links. Web Share API / clipboard support. User incident reporting with 8 types and 3 severity levels.

</td>
</tr>
</table>

<br/>

---

<br/>

## ğŸ—ï¸ System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              FRONTEND â€” React + Vite + TypeScript                   â”‚
â”‚                                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Index.tsx    â”‚  â”‚  GlobeView   â”‚  â”‚  Dashboard   â”‚  â”‚  Emergency System       â”‚  â”‚
â”‚  â”‚  (SPA Root)  â”‚  â”‚  (Mapbox GL) â”‚  â”‚  (Results)   â”‚  â”‚  Call Modal + ActiveBar â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                 â”‚                 â”‚                      â”‚                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                          lib/api.ts â€” Unified API Layer                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€-â”˜  â”‚
â”‚                                   â”‚                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Firebase Auth â”‚ Firestore (reports, profiles) â”‚ RTDB (live call state)       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€-â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€-â”˜
                                       â”‚ HTTPS
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€-â”
â”‚                          BACKEND â€” FastAPI + Python 3.11                             â”‚
â”‚                                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  routes.py  â”‚â”€â”€â”€â–¶â”‚  scoring.py   â”‚â”€â”€â”€â–¶â”‚  ml_model.py (XGBoost .ubj regressor) â”‚    â”‚
â”‚  â”‚  (15 endpts)â”‚    â”‚  (CIA + blend)â”‚    â”‚  25 features Ã— LRU-cached inference   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚        â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                       data_fetchers.py â€” Parallel Async Pipeline               â”‚ â”‚
â”‚  â”‚                                                                                â”‚ â”‚
â”‚  â”‚  FBI CDE â”€â”                          â”Œâ”€ NWS Weather                            â”‚ â”‚
â”‚  â”‚  Socrata â”€â”¤  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”œâ”€ Census Population                      â”‚ â”‚
â”‚  â”‚  NIBRS   â”€â”¤  â”‚  asyncio.gather  â”‚    â”œâ”€ Google Places POIs                     â”‚ â”‚
â”‚  â”‚  UCR DB  â”€â”¤â”€â”€â”‚  (all in parallel)â”‚â”€â”€â”€â”œâ”€ Ticketmaster Events                    â”‚ â”‚
â”‚  â”‚  Citizen â”€â”¤  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”œâ”€ Astronomy (Moon)                       â”‚ â”‚
â”‚  â”‚  Google  â”€â”˜                          â””â”€ Google Routes                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€-â”˜ â”‚
â”‚                                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                          DATASETS â€” Pre-Loaded at Startup                      â”‚  â”‚
â”‚  â”‚  agency_profiles.json (12K+ agencies) â”‚ city_crime_lookup.json (8,986 cities)  â”‚  â”‚
â”‚  â”‚  state_temporal_profiles.json (50+DC) â”‚ college_crime_lookup.json (676)        â”‚  â”‚
â”‚  â”‚  county_crime_lookup.json (2,364)     â”‚ nationwide_data.py (50 states)         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€-â”˜
                                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€-â”
â”‚                    FIREBASE CLOUD FUNCTIONS (2nd Gen)                                â”‚
â”‚                                                                                     â”‚
â”‚  startEmergencyCall â”€â”€â”€ VAPI Outbound Call + RTDB Context Write                     â”‚
â”‚  vapiLlm â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Custom LLM Endpoint (Gemini 2.5 Flash)                      â”‚
â”‚  emergencyCallMessage â”€ RTDB Updates + VAPI "control:say" Injection                 â”‚
â”‚  emergencyCallEnd â”€â”€â”€â”€â”€ VAPI Hangup + RTDB Cleanup                                  â”‚
â”‚  vapiWebhook â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ VAPI Server Events (end-of-call-report)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€-â”˜
```

<br/>

---

<br/>

## ğŸ§  How the Safety Score Works

The safety scoring pipeline is a **10-stage process** that runs in under 2 seconds:

```
Step 1                    Step 2                   Step 3
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“ Geocode   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ âš¡ Parallel   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ ğŸ“Š Crime Rateâ”‚
â”‚ Address      â”‚         â”‚ Data Fetch   â”‚         â”‚ Resolution   â”‚
â”‚              â”‚         â”‚ (8 sources)  â”‚         â”‚ (3-tier)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                         â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â–¼
Step 4                    Step 5                   Step 6
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¤– XGBoost   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ âš–ï¸ 60/40     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ ğŸ¤– Gemini    â”‚
â”‚ 25-Feature   â”‚         â”‚ Hybrid Blend â”‚         â”‚ Refinement   â”‚
â”‚ Inference    â”‚         â”‚              â”‚         â”‚ (optional)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                         â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â–¼
Step 7                    Step 8                   Step 9 & 10
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”´ CIA       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ ğŸ“ˆ 24-Hour   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ ğŸ—ºï¸ Heatmap + â”‚
â”‚ Live Incidentâ”‚         â”‚ Risk Curve   â”‚         â”‚ Response     â”‚
â”‚ Penalty â‰¤25  â”‚         â”‚ Generation   â”‚         â”‚ Assembly     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3-Tier Crime Rate Resolution

The system finds the **most granular** crime data available for any US location:

| Priority | Source | Coverage | Granularity |
|:---:|---|---|---|
| ğŸ¥‡ | **NIBRS Agency Profiles** | 12,000+ agencies | Per-agency offense mix, weapon rates, stranger rates, severity scores, officer counts |
| ğŸ¥ˆ | **FBI UCR Datasets** | 8,986 cities + 676 colleges + 2,364 counties | Annual per-offense crime counts |
| ğŸ¥‰ | **State Baseline** | 50 states + DC | State rate Ã— urban/suburban/rural multiplier |

### XGBoost Feature Vector (25 dimensions)

```python
FEATURE_NAMES = [
    "agency_part1_rate",       # Total Part I crime rate per 100K
    "agency_violent_rate",     # Violent crime rate per 100K
    "agency_property_rate",    # Property crime rate per 100K
    "agency_weapon_rate",      # Weapon offense rate
    "agency_stranger_rate",    # Stranger-on-stranger rate
    "agency_severity_score",   # Weighted severity composite
    "state_crime_rate_norm",   # State-level baseline (normalized)
    "population_group",        # City population category (1-9)
    "hourly_risk_ratio",       # BJS temporal multiplier for current hour
    "dow_risk_ratio",          # Day-of-week crime ratio
    "monthly_risk_ratio",      # Monthly crime seasonality
    "time_sin",                # Circular time encoding (sin)
    "time_cos",                # Circular time encoding (cos)
    "is_weekend",              # Binary weekend flag
    "people_count_norm",       # Group size (log-normalized)
    "gender_factor",           # Gender-based victimization rate
    "weather_severity",        # NWS weather severity (0-1)
    "officer_density",         # Officers per 100K population
    "is_college",              # Campus area flag
    "is_urban",                # Urban/suburban/rural classification
    "poi_density",             # Nearby safety POI density
    "live_events_norm",        # Ticketmaster event count (normalized)
    "live_incidents_norm",     # Citizen incident count (normalized)
    "moon_illumination",       # Lunar phase (0-1)
    "spatial_density_score",   # Spatial crime density from Socrata
]
```

### Citizen Incident Adjustment (CIA)

Real-time scoring modifier using live Citizen app incidents:

```
CIA_penalty = Î£ (distance_decay Ã— recency_decay Ã— severity Ã— credibility Ã— status)
                                                                    capped at 25 points

distance_decay  = Gaussian, half-weight at 0.3 miles
recency_decay   = Exponential, half-life ~2.8 hours
severity        = level + incidentScore + color mapping
credibility     = 911-sourced > community-reported
status          = confirmed â†‘ | closed â†“
```

### BJS Temporal Crime Multipliers

Safety varies dramatically by hour. The system applies **Bureau of Justice Statistics** temporal amplification per offense type:

| Crime Type | Night (10PMâ€“6AM) | Evening (6PMâ€“10PM) | Day (6AMâ€“6PM) |
|:---:|:---:|:---:|:---:|
| **Robbery** | 3.07Ã— | 1.53Ã— | 0.47Ã— |
| **Assault** | 1.69Ã— | 1.42Ã— | 0.62Ã— |
| **Burglary** | 1.35Ã— | 1.15Ã— | 0.74Ã— |
| **Vehicle Theft** | 2.06Ã— | 1.23Ã— | 0.54Ã— |

<br/>

---

<br/>

## ğŸ“ AI Emergency Operator

<table>
<tr>
<td width="50%">

### The Problem
In a dangerous situation, you might not be able to speak. You might be hiding. Someone might be near you. Calling 911 could put you at greater risk.

### The Solution
Lumos's **AI Emergency Operator** calls on your behalf. It speaks to the 911 operator as "LUMOS AI" â€” delivering your name, age, location, incident type, severity, and medical conditions. Every **30 seconds**, it relays your updated GPS coordinates.

You can send **silent text messages** from your phone that the AI reads aloud to the operator in real-time.

### How It Works

```
User â”€â”€textâ”€â”€â–¶ Firebase RTDB â”€â”€â–¶ Cloud Function
                                      â”‚
                                      â–¼
                               VAPI Outbound Call
                                      â”‚
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â–¼           â–¼           â–¼
                    ElevenLabs   Gemini 2.5   Deepgram
                    (Voice)      (Brain)      (Ears)
                          â”‚           â”‚           â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â–¼
                              911 Operator hears:
                              "This is LUMOS AI,
                               calling on behalf of
                               Jane Doe, age 24..."
```

</td>
<td width="50%">

### Call Lifecycle

**Phase 1 â€” Profile Collection**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“‹ Emergency Profile       â”‚
â”‚                             â”‚
â”‚  Name: _______________      â”‚
â”‚  Age:  _______________      â”‚
â”‚  Medical: ____________      â”‚
â”‚  Contact: ____________      â”‚
â”‚  Incident: [Robbery â–¼]     â”‚
â”‚  Severity: [â— High   ]     â”‚
â”‚                             â”‚
â”‚  [ğŸ“ Start AI Call]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Phase 2 â€” 10s Countdown** *(cancel window)*

**Phase 3 â€” Active Call**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”´ LUMOS AI CALL ACTIVE    â”‚
â”‚  Duration: 02:34            â”‚
â”‚                             â”‚
â”‚  ğŸ“ GPS: 33.7490, -84.3880 â”‚
â”‚  ğŸ“ Updated 12s ago        â”‚
â”‚                             â”‚
â”‚  ğŸ’¬ Type message to relay:  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ He went north on    â”‚    â”‚
â”‚  â”‚ Peachtree Street    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  [Send to Operator]         â”‚
â”‚                             â”‚
â”‚  ğŸ“ Live Transcript:        â”‚
â”‚  "...dispatching unit to    â”‚
â”‚   your location now..."     â”‚
â”‚                             â”‚
â”‚  [End Call]                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

</td>
</tr>
</table>

### Voice Stack

| Component | Technology | Role |
|:---------:|:----------:|------|
| ğŸ§  **Brain** | Gemini 2.5 Flash | Conversational AI that speaks to the 911 operator, processes context, adapts responses |
| ğŸ—£ï¸ **Voice** | ElevenLabs | Neural text-to-speech synthesis â€” natural, calm emergency voice |
| ğŸ‘‚ **Ears** | Deepgram Nova-2 | Real-time speech-to-text transcription of the operator's responses |
| ğŸ“ **Caller** | VAPI | Outbound call orchestration â€” manages the phone call lifecycle |
| ğŸ”„ **Relay** | Firebase RTDB | Real-time state sync between user's phone and the active call |

<br/>

---

<br/>

## ğŸ—‚ï¸ Data Pipeline

```
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚        RAW DATA SOURCES              â”‚
                         â”‚                                      â”‚
                         â”‚  FBI NIBRS â”€â”€â”€ 12,000+ agencies      â”‚
                         â”‚  FBI UCR  â”€â”€â”€ 8,986 cities           â”‚
                         â”‚              676 colleges            â”‚
                         â”‚              2,364 counties          â”‚
                         â”‚  FBI CDE  â”€â”€â”€ State-level trends     â”‚
                         â”‚  Socrata  â”€â”€â”€ 30+ city portals       â”‚
                         â”‚  Census   â”€â”€â”€ Population data        â”‚
                         â”‚  NWS      â”€â”€â”€ Weather conditions     â”‚
                         â”‚  Citizen  â”€â”€â”€ Live incidents          â”‚
                         â”‚  Ticketmaster â”€ Local events          â”‚
                         â”‚  Astronomy â”€â”€â”€ Moon phase             â”‚
                         â”‚  Google Places â”€ POIs                 â”‚
                         â”‚  Google Routes â”€ Directions           â”‚
                         â”‚                                      â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚     PREPROCESSING & CACHING          â”‚
                         â”‚                                      â”‚
                         â”‚  city_crime_loader â”€â”€ UCR lookup DB   â”‚
                         â”‚  fbi_cde_loader â”€â”€â”€â”€ API response     â”‚
                         â”‚  nibrs_data â”€â”€â”€â”€â”€â”€â”€â”€ Agency profiles  â”‚
                         â”‚  nationwide_data â”€â”€â”€ 50-state base    â”‚
                         â”‚  cache.py â”€â”€â”€â”€â”€â”€â”€â”€â”€ TTL in-memory     â”‚
                         â”‚                                      â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚     ML INFERENCE & SCORING           â”‚
                         â”‚                                      â”‚
                         â”‚  25-feature vector construction       â”‚
                         â”‚           â”‚                          â”‚
                         â”‚     â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”                    â”‚
                         â”‚     â–¼           â–¼                    â”‚
                         â”‚  XGBoost    Formula                  â”‚
                         â”‚  (60%)      (40%)                    â”‚
                         â”‚     â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                    â”‚
                         â”‚           â–¼                          â”‚
                         â”‚     Blended Score                    â”‚
                         â”‚           â”‚                          â”‚
                         â”‚     â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”                    â”‚
                         â”‚     â–¼           â–¼                    â”‚
                         â”‚  Gemini       CIA                    â”‚
                         â”‚  Refine     Penalty                  â”‚
                         â”‚     â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                    â”‚
                         â”‚           â–¼                          â”‚
                         â”‚     Final Score (5â€“95)               â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Socrata Open Data Coverage (30+ Cities)

<details>
<summary><b>Expand full city list</b></summary>

| City | City | City | City |
|------|------|------|------|
| Chicago, IL | New York, NY | Los Angeles, CA | San Francisco, CA |
| Seattle, WA | Atlanta, GA | Philadelphia, PA | Boston, MA |
| Austin, TX | Denver, CO | Washington, DC | Nashville, TN |
| Dallas, TX | Houston, TX | Baltimore, MD | Detroit, MI |
| Minneapolis, MN | Sacramento, CA | Kansas City, MO | San Antonio, TX |
| Columbus, OH | Tucson, AZ | Louisville, KY | St. Louis, MO |
| Cincinnati, OH | Charlotte, NC | Pittsburgh, PA | Mesa, AZ |
| Raleigh, NC | Oakland, CA | *+ dynamic ODN discovery for unlisted cities* | |

</details>

<br/>

---

<br/>

## ğŸ› ï¸ Tech Stack

<table>
<tr>
<th align="center">Layer</th>
<th align="center">Technology</th>
</tr>
<tr>
<td><b>âš›ï¸ Frontend</b></td>
<td>React 18 Â· TypeScript Â· Vite 5 (SWC) Â· Tailwind CSS 3 Â· shadcn/ui (Radix primitives) Â· React Router 6 Â· Framer Motion 11</td>
</tr>
<tr>
<td><b>ğŸ—ºï¸ Mapping</b></td>
<td>Mapbox GL JS 3.18 â€” globe projection, heatmap layers, circle layers, route polylines, cinematic flyTo</td>
</tr>
<tr>
<td><b>ğŸ“Š Charting</b></td>
<td>Recharts 2.15 â€” area, line, and bar charts for risk curves and historical trends</td>
</tr>
<tr>
<td><b>ğŸ” Auth & DB</b></td>
<td>Firebase Auth (Google sign-in) Â· Firestore (reports, profiles) Â· Realtime Database (live call state)</td>
</tr>
<tr>
<td><b>â˜ï¸ Serverless</b></td>
<td>Firebase Cloud Functions (2nd gen) â€” <code>onCall</code> / <code>onRequest</code> for VAPI integration</td>
</tr>
<tr>
<td><b>ğŸ Backend</b></td>
<td>Python 3.11 Â· FastAPI Â· uvicorn Â· httpx (async) Â· orjson</td>
</tr>
<tr>
<td><b>ğŸ¤– ML</b></td>
<td>XGBoost regressor (.ubj) â€” 25 features, sigmoid ground truth, LRU-cached inference</td>
</tr>
<tr>
<td><b>ğŸ§  AI</b></td>
<td>Google Gemini 2.5 Flash â€” safety tips, chat, score refinement, heatmap enrichment, route recommendations, emergency operator</td>
</tr>
<tr>
<td><b>ğŸ—£ï¸ Voice</b></td>
<td>VAPI (outbound calling) Â· ElevenLabs (TTS) Â· Deepgram Nova-2 (STT)</td>
</tr>
<tr>
<td><b>ğŸš€ Deploy</b></td>
<td>Frontend: <a href="https://lumos-safety.netlify.app">lumos-safety.netlify.app</a> Â· Backend: uvicorn Â· Functions: Firebase Cloud Run</td>
</tr>
</table>

<br/>

---

<br/>

## ğŸ”Œ API Integrations

> **15+ external APIs** fetched in parallel via `asyncio.gather` for sub-2-second response times.

| # | API | Purpose | What We Get |
|:-:|:---:|---------|-------------|
| 1 | ğŸ” **FBI CDE** | Crime Data Explorer | State-level crime stats, historical multi-year trends |
| 2 | ğŸ“‹ **FBI UCR** | Uniform Crime Reports | 8,986 cities + 676 colleges + 2,364 counties |
| 3 | ğŸ“¡ **Socrata** | Open Data Portals | Real-time incident data from 30+ cities |
| 4 | ğŸŒ§ï¸ **NWS** | National Weather Service | Weather conditions and severity |
| 5 | â˜ï¸ **OpenWeatherMap** | Weather Fallback | Secondary weather source |
| 6 | ğŸ‘¥ **Census** | Population Bureau | Per-capita normalization |
| 7 | ğŸ“ **Google Geocoding** | Address Resolution | Address â†” coordinates |
| 8 | ğŸ¥ **Google Places** | Nearby POIs | Police, hospitals, fire stations |
| 9 | ğŸ›£ï¸ **Google Routes** | Directions | Waypoints, duration, polylines |
| 10 | ğŸ”´ **Citizen** | Live Incidents | Real-time trending feed |
| 11 | ğŸ« **Ticketmaster** | Local Events | Crowd density proxy |
| 12 | ğŸŒ™ **Astronomy API** | Moon Phase | Illumination (visibility) |
| 13 | ğŸ¤– **Gemini 2.5 Flash** | AI Intelligence | Tips, chat, refinement, emergency LLM |
| 14 | ğŸ“ **VAPI** | Voice Calls | Outbound emergency calls |
| 15 | ğŸ—£ï¸ **ElevenLabs** | Text-to-Speech | AI operator voice |
| 16 | ğŸ‘‚ **Deepgram** | Speech-to-Text | Nova-2 transcription |

<br/>

---

<br/>

## ğŸ“¡ Backend API Reference

All endpoints served from FastAPI (default: `http://localhost:8000`).

**Rate Limit**: 30 requests / minute / IP &nbsp;Â·&nbsp; **CORS**: `lumos-ai.live`, `localhost:*`

| Method | Endpoint | Description |
|:------:|----------|-------------|
| `POST` | `/api/safety` | **Core** â€” Full safety analysis with parallel data fetch, XGBoost + CIA â†’ SafetyResponse |
| `POST` | `/api/route` | Route analysis â€” Google Routes â†’ waypoint sampling â†’ per-segment scoring |
| `GET` | `/api/historical` | Multi-year FBI crime trends by state |
| `GET` | `/api/nearby-pois` | Safety POIs via Google Places |
| `GET` | `/api/citizen-hotspots` | Citizen trending incidents proxy |
| `POST` | `/api/ai-tips` | Gemini safety tips (4 structured, JSON) |
| `POST` | `/api/safety-chat` | Conversational Q&A (Gemini + location context) |
| `POST` | `/api/route-recommendation` | AI route recommendation |
| `GET` | `/api/incident-summary` | AI incident summary |
| `POST` | `/api/reports` | Submit incident report |
| `GET` | `/api/reports` | Get nearby reports |
| `GET` | `/api/geocode` | Geocoding proxy |
| `GET` | `/api/autocomplete` | Places autocomplete proxy |
| `POST` | `/api/emergency-call` | Direct emergency call trigger |
| `GET` | `/api/health` | Health check |

<details>
<summary><b>ğŸ“ Example: Safety Score Request</b></summary>

```bash
curl -X POST http://localhost:8000/api/safety \
  -H "Content-Type: application/json" \
  -d '{
    "lat": 33.7490,
    "lng": -84.3880,
    "timeOfTravel": "22:00",
    "duration": 60,
    "peopleCount": 1,
    "gender": "female",
    "travelMode": "walking"
  }'
```

**Response** (abridged):
```json
{
  "safetyScore": 42,
  "riskLevel": "caution",
  "location": "Atlanta, GA",
  "crimeRate": 5834.2,
  "hourlyRisk": [0.31, 0.28, 0.25, "...24 values"],
  "incidentTypes": {
    "Assault": 24.3,
    "Robbery": 18.7,
    "Theft": 31.2
  },
  "weather": { "condition": "Clear", "severity": 0.1 },
  "nearbyPOIs": ["..."],
  "aiTips": ["..."],
  "emergencyNumbers": { "police": "911" },
  "heatmapData": ["..."],
  "citizenIncidents": ["..."],
  "dataSources": ["FBI NIBRS", "Socrata ATL", "NWS", "Citizen"]
}
```

</details>

<br/>

---

<br/>

## âš¡ Quick Start

### Prerequisites

| Requirement | Version |
|:-----------:|:-------:|
| Node.js | â‰¥ 18 |
| Python | 3.11 |
| npm | â‰¥ 9 |

### 1ï¸âƒ£ Clone & Install

```bash
git clone https://github.com/your-org/lumos.ai.git
cd lumos.ai
npm install
```

### 2ï¸âƒ£ Environment Variables

Create a `.env` file in the project root:

```dotenv
# Frontend (Vite)
VITE_MAPBOX_TOKEN=<your-mapbox-token>
VITE_GOOGLE_MAPS_API_KEY=<your-google-maps-key>
VITE_GEMINI_API_KEY=<your-gemini-key>
VITE_API_BASE_URL=http://localhost:8000

# Firebase
VITE_FIREBASE_API_KEY=<key>
VITE_FIREBASE_AUTH_DOMAIN=<project>.firebaseapp.com
VITE_FIREBASE_PROJECT_ID=<project>
VITE_FIREBASE_STORAGE_BUCKET=<project>.firebasestorage.app
VITE_FIREBASE_MESSAGING_SENDER_ID=<id>
VITE_FIREBASE_APP_ID=<id>
VITE_FIREBASE_MEASUREMENT_ID=<id>

# Backend
DATA_GOV_API_KEY=<fbi-key>
GOOGLE_MAPS_API_KEY=<key>
GEMINI_API_KEY=<key>
```

> Ask a team member for actual values â€” never commit `.env` to git.

### 3ï¸âƒ£ Backend Setup

```bash
cd backend
python3.11 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

### 4ï¸âƒ£ Launch

```bash
# Terminal 1 â€” Backend (port 8000)
cd backend && source venv/bin/activate && python main.py

# Terminal 2 â€” Frontend (port 8080)
npm run dev
```

ğŸŒ Open **http://localhost:8080** and start exploring.

<br/>

---

<br/>

## ğŸ“ Project Structure

```
lumos.ai/
â”‚
â”œâ”€â”€ ğŸ“„ .env                          # API keys (gitignored)
â”œâ”€â”€ ğŸ“„ package.json                  # Frontend deps & scripts
â”œâ”€â”€ ğŸ“„ vite.config.ts                # Vite (port 8080, SWC)
â”œâ”€â”€ ğŸ“„ tailwind.config.ts            # Tailwind + custom theme
â”œâ”€â”€ ğŸ“„ firebase.json                 # Firebase config
â”‚
â”œâ”€â”€ ğŸ¨ src/                          # â”€â”€ FRONTEND â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚   â”œâ”€â”€ App.tsx                      # Root + routing
â”‚   â”œâ”€â”€ main.tsx                     # Entry point
â”‚   â”‚
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ Index.tsx                # Main SPA (1,660 lines)
â”‚   â”‚   â””â”€â”€ NotFound.tsx             # 404
â”‚   â”‚
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ SafetyDashboard.tsx      # Score gauge, risk badge, crime bars
â”‚   â”‚   â”œâ”€â”€ GlobeView.tsx            # 3D Mapbox GL globe + heatmaps
â”‚   â”‚   â”œâ”€â”€ SafetyChatWidget.tsx     # Floating Gemini chat
â”‚   â”‚   â”œâ”€â”€ RouteSafetyPanel.tsx     # Route segments + warnings
â”‚   â”‚   â”œâ”€â”€ RouteSearchBar.tsx       # Dual-mode search + autocomplete
â”‚   â”‚   â”œâ”€â”€ WalkWithMe.tsx           # GPS tracking + auto-arrival
â”‚   â”‚   â”œâ”€â”€ EmergencyCallModal.tsx   # AI call: profile â†’ countdown â†’ active
â”‚   â”‚   â”œâ”€â”€ ActiveCallBar.tsx        # Draggable call bar + transcript
â”‚   â”‚   â”œâ”€â”€ EmergencyProfileModal.tsx # Profile editor
â”‚   â”‚   â”œâ”€â”€ EmergencyResources.tsx   # Emergency numbers (911, 988)
â”‚   â”‚   â”œâ”€â”€ LiveIncidents.tsx        # Citizen feed
â”‚   â”‚   â”œâ”€â”€ HourlyRiskChart.tsx      # 24-hour risk curve
â”‚   â”‚   â”œâ”€â”€ HistoricalTrends.tsx     # FBI trend lines
â”‚   â”‚   â”œâ”€â”€ NearbyPOIs.tsx           # Police, hospitals, fire
â”‚   â”‚   â”œâ”€â”€ AISafetyTips.tsx         # 4 Gemini tips
â”‚   â”‚   â”œâ”€â”€ ParameterPanel.tsx       # Time/gender/group/mode
â”‚   â”‚   â”œâ”€â”€ HeatmapLegend.tsx        # Layer legend
â”‚   â”‚   â”œâ”€â”€ ReportIncident.tsx       # User reports
â”‚   â”‚   â”œâ”€â”€ ExportReport.tsx         # .txt export
â”‚   â”‚   â”œâ”€â”€ ShareReport.tsx          # Share via URL/clipboard
â”‚   â”‚   â”œâ”€â”€ UserMenu.tsx             # Auth + saved reports
â”‚   â”‚   â””â”€â”€ ui/                      # 40+ shadcn/ui primitives
â”‚   â”‚
â”‚   â”œâ”€â”€ hooks/                       # useAuth, useEmergencyProfile, useTheme
â”‚   â”œâ”€â”€ lib/                         # api, firebase, gemini, heatmap, utils
â”‚   â””â”€â”€ types/                       # TypeScript interfaces
â”‚
â”œâ”€â”€ ğŸ backend/                      # â”€â”€ BACKEND â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚   â”œâ”€â”€ main.py                      # FastAPI + uvicorn
â”‚   â”œâ”€â”€ routes.py                    # 15 endpoints
â”‚   â”œâ”€â”€ scoring.py                   # Score computation + CIA
â”‚   â”œâ”€â”€ ml_model.py                  # XGBoost inference
â”‚   â”œâ”€â”€ data_fetchers.py             # Parallel async (15+ APIs)
â”‚   â”œâ”€â”€ models.py                    # Pydantic schemas
â”‚   â”œâ”€â”€ config.py                    # Constants + features
â”‚   â”œâ”€â”€ cache.py                     # TTL in-memory cache
â”‚   â”œâ”€â”€ nibrs_data.py                # Agency profile loader
â”‚   â”œâ”€â”€ city_crime_loader.py         # UCR lookup DB
â”‚   â”œâ”€â”€ fbi_cde_loader.py            # FBI CDE cache
â”‚   â”œâ”€â”€ nationwide_data.py           # 50-state baseline
â”‚   â”œâ”€â”€ train_safety_model.py        # Training script
â”‚   â””â”€â”€ safety_model_xgb.ubj        # Trained model
â”‚
â”œâ”€â”€ ğŸ“Š datasets/                     # â”€â”€ DATASETS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚   â”œâ”€â”€ agency_profiles.json         # 12K+ agencies
â”‚   â”œâ”€â”€ city_crime_lookup.json       # 8,986 cities
â”‚   â”œâ”€â”€ college_crime_lookup.json    # 676 colleges
â”‚   â”œâ”€â”€ county_crime_lookup.json     # 2,364 counties
â”‚   â”œâ”€â”€ state_temporal_profiles.json # 50 + DC temporal data
â”‚   â””â”€â”€ training_metadata.json       # Model metadata
â”‚
â”œâ”€â”€ â˜ï¸  functions/                    # â”€â”€ CLOUD FUNCTIONS â”€â”€â”€â”€â”€â”€
â”‚   â”œâ”€â”€ index.js                     # VAPI + Gemini + RTDB
â”‚   â””â”€â”€ package.json
â”‚
â””â”€â”€ ğŸŒ public/                       # â”€â”€ STATIC â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”œâ”€â”€ manifest.json                # PWA manifest
    â””â”€â”€ sw.js                        # Service worker
```

<br/>

---

<br/>

## ğŸ§ª Testing

```bash
npm run test          # Run all tests (Vitest)
npm run test:watch    # Watch mode
```

Tests use **Vitest** + **React Testing Library** + **jsdom**.

<br/>

---

<br/>

## ğŸš€ Deployment

| Component | Platform | URL |
|:---------:|:--------:|:---:|
| Frontend | Surge / Vite Build | [lumos-safety.netlify.app](https://lumos-safety.netlify.app) |
| Backend | uvicorn | Port 8000 |
| Functions | Firebase Cloud Run | Auto-deployed |

```bash
npm run build              # Build frontend
npm run firebase:deploy    # Deploy Cloud Functions
```

<br/>

---

<br/>

## ğŸ› Troubleshooting

| Problem | Solution |
|---------|----------|
| `ModuleNotFoundError` | Activate venv: `source backend/venv/bin/activate` |
| Port 8000 in use | `lsof -ti:8000 \| xargs kill -9` |
| Port 8080 in use | `lsof -ti:8080 \| xargs kill -9` |
| Map not loading | Verify `VITE_MAPBOX_TOKEN` in `.env` |
| XGBoost lazy-load message | Normal â€” loads on first prediction |
| Frontend â†› Backend | Check `VITE_API_BASE_URL=http://localhost:8000` |
| Firebase auth errors | Verify all `VITE_FIREBASE_*` keys |
| Gemini failures | Check `GEMINI_API_KEY` in `.env` |

<br/>

---

<br/>

## ğŸ“‹ Scripts

```bash
# â”€â”€ Frontend â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
npm run dev              # Dev server (port 8080)
npm run build            # Production build
npm run build:dev        # Development build
npm run lint             # ESLint
npm run test             # Vitest
npm run test:watch       # Vitest watch mode
npm run preview          # Preview build
npm run firebase:deploy  # Deploy functions

# â”€â”€ Backend â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
python main.py                   # API server (port 8000)
python train_safety_model.py     # Retrain XGBoost
python collect_state_data.py     # Collect training data
python precompute_nibrs.py       # Precompute agency profiles
```

<br/>

---

<br/>

## ğŸ‘¥ Team

Built with â˜• and sleepless nights at **Hacklytics 2026** â€” Georgia Tech.

<br/>

---

<br/>

<p align="center">
  <img src="https://img.shields.io/badge/BUILT_WITH-â¤ï¸_AT_HACKLYTICS_2026-FFD700?style=for-the-badge&labelColor=0d1117" alt="Built at Hacklytics"/>
</p>

<p align="center">
  <i>Because everyone deserves to feel safe. ğŸ•¯ï¸</i>
</p>

<p align="center">
  <sub>Lumos â€” <b>light in the darkness.</b></sub>
</p>
